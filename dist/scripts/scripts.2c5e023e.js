function stackBoxBlur(a,b,c,d,e,f){if(!(isNaN(f)||1>f)){f|=0;var g,h,i,j,k,l,m,n,o,p,q,r,s,t=2,u=a.getContext("2d"),v=u.getImageData(b,c,d,e),w=v.data,x=f+f+1,y=d-1,z=e-1,A=f+1,B=new BlurStack,C=B;for(i=1;x>i;i++)if(C=C.next=new BlurStack,i==A);C.next=B;for(var D=null,E=mul_table[f],F=shg_table[f];t-->0;){for(m=l=0,h=e;--h>-1;){for(n=A*(q=w[l]),o=A*(r=w[l+1]),p=A*(s=w[l+2]),C=B,i=A;--i>-1;)C.r=q,C.g=r,C.b=s,C=C.next;for(i=1;A>i;i++)j=l+((i>y?y:i)<<2),n+=C.r=w[j++],o+=C.g=w[j++],p+=C.b=w[j],C=C.next;for(D=B,g=0;d>g;g++)w[l++]=n*E>>>F,w[l++]=o*E>>>F,w[l++]=p*E>>>F,l++,j=m+((j=g+f+1)<y?j:y)<<2,n-=D.r-(D.r=w[j++]),o-=D.g-(D.g=w[j++]),p-=D.b-(D.b=w[j]),D=D.next;m+=d}for(g=0;d>g;g++){for(l=g<<2,n=A*(q=w[l++]),o=A*(r=w[l++]),p=A*(s=w[l]),C=B,i=0;A>i;i++)C.r=q,C.g=r,C.b=s,C=C.next;for(k=d,i=1;f>=i;i++)l=k+g<<2,n+=C.r=w[l++],o+=C.g=w[l++],p+=C.b=w[l],C=C.next,z>i&&(k+=d);for(l=g,D=B,h=0;e>h;h++)j=l<<2,w[j]=n*E>>>F,w[j+1]=o*E>>>F,w[j+2]=p*E>>>F,j=g+((j=h+A)<z?j:z)*d<<2,n-=D.r-(D.r=w[j]),o-=D.g-(D.g=w[j+1]),p-=D.b-(D.b=w[j+2]),D=D.next,l+=d}}u.putImageData(v,b,c)}}function BlurStack(){this.r=0,this.g=0,this.b=0,this.a=0,this.next=null}!function(a){var b={init:function(b,c){var d=this;d.orig=a(b),d.vals={},d.options=a.extend({},a.fn.gridView.defaults,c),d.build(),d.attachEvents()},build:function(){var a=this,b=a.vals;a.orig.addClass(a.options.template),a.cont=a.orig.find(".grid_cont").jScroll({mode:"h",pad:23,autoresize:!1}),a.body=a.orig.find(".grid_body"),a.item=a.orig.find(".grid_item"),b.itemM=parseInt(a.item.css("marginBottom"))},update:function(b){var c,d,e=this,f=e.vals;if(f.contW=e.cont.width(),f.contH=e.cont.height(),f.itemW=Math.round(f.contW*e.options.itemWidth/100),f.itemH=0==e.options.itemHeight?Math.round(.5625*f.itemW):e.options.itemHeight,c=f.itemH+f.itemM,b&&(e.item=e.orig.find(".grid_item")),e.options.columns){var g=Math.floor(f.contH/c)+(f.contH%c>=f.itemH?1:0),h=0;e.item.each(function(){0!=a(this).parent(".grid_col").length&&a(this).unwrap()});for(var i=0;i<e.item.length;i+=g)h++,e.item.slice(i,i+g).wrapAll('<div class="grid_col" style="width: '+f.itemW+'px;"></div>');d=h*(f.itemW+50)-50}else d=e.item.length*(f.itemW+50);e.item.css({height:f.itemH+"px",width:f.itemW+"px"}),e.body.css({width:d+"px"}),e.cont.jScroll("update")},attachEvents:function(){var b=this;a(window).on("resize",a.proxy(b.update,b,!1))}};a.fn.gridView=function(c,d){return this.each(function(){var e=a.data(this,"gView");if(e){if(e[c])return e[c](d)}else e=Object.create(b),e.init(this,c),a.data(this,"gView",e)})},a.fn.gridView.defaults={columns:!0,itemWidth:30,itemHeight:0,columnMargin:50}}(jQuery),function(a){a.fn.replaceText=function(b,c,d){return this.each(function(){var e,f,g=this.firstChild,h=[];if(g)do 3===g.nodeType&&(e=g.nodeValue,f=e.replace(b,c),f!==e&&(!d&&/</.test(f)?(a(g).before(f),h.push(g)):g.nodeValue=f));while(g=g.nextSibling);h.length&&a(h).remove()})}}(jQuery),function(a,b,c,d){var e={init:function(b,c){var d=this;d.elem=a(b),d.vals={},d.vidp={},d.options=a.extend({},a.fn.adPlayer.defaults,c),d.build()},build:function(){var d=this,e=d.vals;e.plbk=!0,e.time=0,e.wait=!1,e.browser={},e.browser.opera=!!b.opera||navigator.userAgent.indexOf(" OPR/")>=0,e.browser.firefox="undefined"!=typeof InstallTrigger,e.browser.safari=Object.prototype.toString.call(b.HTMLElement).indexOf("Constructor")>0,e.browser.chrome=!!b.chrome&&!e.browser.opera,e.browser.ie=!!c.documentMode,e.cnvw=640,e.cnvh=360,d.elem.append('<div class="adplay_msg"></div><div class="adplay_ovr"><div class="adplay_vig"></div><canvas width="'+e.cnvw+'" height="'+e.cnvh+'" class="adplay_blr"></canvas>'),d.elem.data("id",null),d.vidp.msg=d.elem.find(".adplay_msg"),d.vidp.ovr=d.elem.find(".adplay_ovr"),d.vidp.blr=d.elem.find(".adplay_blr"),d.vidp.con=d.vidp.blr[0].getContext("2d"),a.proxy(d.utils.setSize,d)(),d.load(d.options.video),d.attachEvents(!1)},load:function(b,c){var d=this,e=d.vals;b&&(d.options.video=b.video.url,d.options.poster=b.poster.url,d.options.groups=b.groups),null!=d.options.video&&(d.vidp.vid?d.vidp.vid.attr("src",d.options.video):(d.vidp.vid=a('<video crossorigin="anonymous" src="'+d.options.video+'" class="adplay_vid" width="'+e.w+'" height="'+e.h+'" type="video/mp4" style="left: '+e.ol+"px; top: "+e.ot+'px"></video>').appendTo(d.elem),d.attachEvents(!0)),d.vidp.msg.html("Click / Tap on the screen to begin video ad playback.").fadeIn(100),a.proxy(d.utils.setPoster,d,d.options.poster)(),d.vidp.vid[0].load(),b.seekTime>=0&&d.vidp.vid[0].addEventListener("loadedmetadata",function(){d.vidp.vid[0].currentTime=b.seekTime},!1),d.vidp.vid.prop("volume",.5))},seekAndPlay:function(b){b&&(a.proxy(self.utils.setPoster,self,b.thumbnail)(),self.vidp.vid[0].load(),b.time&&self.vidp.vid.prop("currentTime",b.time))},play:function(b,c){var d=this,e=d.vals,b="undefined"==typeof b?!1:b;return d.vidp.vid?void(d.vidp.vid.prop("paused")&&!b?(d.vidp.msg.fadeOut(200),d.vidp.ovr.fadeOut(200,function(){d.vidp.vid[0].play(),e.plbk=!0,"function"==typeof c&&c(!0)})):null!==d.elem.data("id")&&(d.vidp.vid[0].pause(),d.vidp.msg.fadeOut(200),b&&d.vidp.vid.prop("currentTime",0),e.plbk=!1,a.proxy(d.utils.setPoster,d,null,function(){d.vidp.ovr.fadeIn(200,function(){d.elem.trigger(b?"adPlayerEnd":"adPlayerPause"),"function"==typeof c&&c(!0)})})())):void c(!1)},seek:function(b,c){var d=this;d.vidp.vid.prop("currentTime",b),setTimeout(function(){d.vidp.vid.hide(),d.vidp.blr.fadeOut(200,function(){a.proxy(d.utils.setPoster,d,null,function(){d.vidp.blr.fadeIn(200,function(){d.vidp.vid.show(),"function"==typeof c&&c()})})()})},500)},attachEvents:function(c){var d=this,e=d.vals;c?(d.vidp.vid.on("timeupdate",a.proxy(d.utils.updateTime,d)),d.vidp.vid.on("ended",a.proxy(d.play,d,!0)),d.vidp.vid.on("click",a.proxy(d.play,d,!1)),e.browser.ie||e.browser.chrome?(e.check=setInterval(a.proxy(d.utils.bufferCheck,d),1e3),d.vidp.vid.on("progress",a.proxy(d.utils.updateBuffer,d))):d.vidp.vid.on("waiting",a.proxy(d.utils.wait,d,!0)),d.vidp.ovr.on("click",a.proxy(d.play,d,!1))):a(b).on("resize",a.proxy(d.utils.setSize,d))},utils:{updateTime:function(){var a=this,b=a.vals;if(b.time=a.vidp.vid.prop("currentTime"),b.currentIntTime=parseInt(b.time),a.options.groups)for(var c=0;c<a.options.groups.length&&(null!=a.options.groups[c]&&b.time>=a.options.groups[c]&&a.elem.data("id",c),!(a.options.groups[c+1]>b.time));c++);},bufferCheck:function(){var b=this,c=b.vals,d=b.vidp.vid.prop("currentTime");b.vidp.vid.prop("paused")||(c.time==d?c.wait||(c.wait=!0,a.proxy(b.utils.wait,b,!0)()):c.wait&&(c.wait=!1,a.proxy(b.utils.wait,b,!1)()))},updateBuffer:function(a){var c=this,e=c.vals,f=c.vidp.vid[0],g=null;f.buffered&&f.buffered.length>0&&f.buffered.end&&f.duration?g=f.buffered.end(0)/f.duration:f.bytesTotal!=d&&f.bytesTotal>0&&f.bufferedBytes!=d&&(g=f.bufferedBytes/f.bytesTotal),1==g&&b.clearInterval(e.check)},setSize:function(){var c=this,d=c.vals,e=a(b).width(),f=a(b).height(),g=e>=1.7778*f;d.w=g?e:Math.round(1.7778*f),d.h=g?Math.round(.5625*e):f,d.ol=Math.round((e-d.w)/2),d.ot=Math.round((f-d.h)/2),c.vidp.blr.css({width:d.w+"px",height:d.h+"px",left:d.ol+"px",top:d.ot+"px"}),c.vidp.vid&&(c.vidp.vid[0].width=d.w,c.vidp.vid[0].height=d.h,c.vidp.vid.css({left:d.ol+"px",top:d.ot+"px"}))},setPoster:function(a,b){var c=this,d=c.vals;if(a){var e=new Image;e.crossOrigin="anonymous",e.onload=function(){c.vidp.con.drawImage(e,0,0,d.cnvw,d.cnvh)},e.src=a}else c.vidp.con.drawImage(c.vidp.vid[0],0,0,d.cnvw,d.cnvh),stackBoxBlur(c.vidp.blr[0],0,0,d.cnvw,d.cnvh,8),"function"==typeof b&&b()},wait:function(b){var c=this;b?(c.vidp.msg.html('<img src="assets/images/loader.gif"><br>Buffering...'),c.vidp.vid.on("canplay",a.proxy(c.utils.wait,c,!1))):c.vidp.vid.off("canplay"),c.vidp.msg[b?"fadeIn":"fadeOut"](200)}}};a.fn.adPlayer=function(b,c,d){return this.each(function(){var f=a.data(this,"adPlayer");if(f){if(f[b])return f[b](c,d)}else f=Object.create(e),console.log(f),f.init(this,b),a.data(this,"adPlayer",f)})},a.fn.adPlayer.defaults={video:null,poster:null,groups:null}}(jQuery,window,document),function(a){var b={init:function(b,c){var d=this;d.orig=a(b),d.vals={},d.view={},d.options=a.extend({},a.fn.videoAd.defaults,c),d.build()},build:function(){var b=this,c=b.vals;b.canPlay(),c.done=a.Deferred(),b.head=b.orig.find("#main_head"),b.back=b.head.find(".head_back"),b.ctrl=b.head.find(".head_ctrl"),b.mttl=b.head.find(".head_title"),b.view.error=b.orig.find("#main_error"),a.isEmptyObject(b.options.adData)?a.ajax({type:"get",url:"assets/response/ads.php",processData:!1,contentType:!1,dataType:"json",success:function(a){b.options.adData=a,c.done.resolve("ajaxOk")},error:function(a){c.done.resolve("ajaxEr")}}):c.done.resolve("ajaxNa"),a.when(c.done).then(function(d){"ajaxEr"==d?(b.view.current="error",b.view.error.html("Error: Unable to retrieve data. If you are using any ad blocking software/plugins, please disable them and try again.")):c.canpl?a.isEmptyObject(b.options.adData)?(b.view.current="error",b.view.error.html("There are no video ads to display.")):(b.view.current=b.options.start,b.view.start=b.orig.find("#main_start").gridView({template:"grid_start",itemWidth:60}),b.view.group=b.orig.find("#main_group").gridView({template:"grid_group",itemWidth:60,itemHeight:110}),b.view.groups=b.orig.find("#main_groups").gridView({template:"grid_groups",columns:!1,itemWidth:23}),b.view.item=b.orig.find("#main_item"),b.view.item.find(".item_main").jScroll({mode:"h",pad:23,autoresize:!1}),b.view.item.find(".item_imgs_thmb").jScroll(),b.view.item.find(".item_revw_rgrp").jScroll(),b.view.search=b.orig.find("#main_search"),b.view.search.find(".search_results").jScroll({pad:23}),b.view.play=b.orig.find("#main_play").adPlayer(),b.attachEvents()):(b.view.current="error",b.view.error.html("Your browser is not compatible with this application's video format. In order to run this application, you need to upgrade to the latest version of either Firefox (Windows), Chrome (Windows, OSX), Safari (OSX) or IE (Windows).")),b.switchView(b.view.current)})},update:function(a){var b=this;"undefined"!=typeof a&&(b.options.adData=a,b.vals.ad=b.vals.group=b.vals.item=0,b.switchView("start"))},switchView:function(b,c){function d(b,c,d){function e(c,d){c.css({visibility:"visible"}).animate({opacity:b?1:0},g.options.animation,function(){a(this).css({visibility:b?"visible":"hidden"}),"function"==typeof d&&d()})}g.view[g.view.current].hasClass("view_hasHead")&&(c||e(g.head)),e(g.view[g.view.current],d)}function e(a){g.fill(a),d(!0)}var f,g=this,b=b?b:g.options.map[g.view.current].item;c?(f=a(c.currentTarget).data("id"),"adPlayerPause"==c.type&&null!==f&&(g.view.current=b,e(f)),"adPlayerEnd"==c.type&&(g.view.current=b,e(g.vals.video)),"click"==c.type&&(a(c.currentTarget).hasClass("button_resume")?d(!1,!1,function(){g.view.current="play",g.view.play.adPlayer("play")}):a(c.currentTarget).hasClass("button_locate")?g.view.play.adPlayer("seek",g.view.group.data("time"),function(){d(!1,!1,function(){g.view.current="play",g.view.play.adPlayer("play")})}):a(c.currentTarget).hasClass("button_start")?d(!1,g.view.current==b,function(){g.view.current=b,g.view.play.css({visibility:"hidden",opacity:0}),e(f)}):"search"==g.view.current?g.searchPanel(!1,function(){d(!1,!1,function(){g.view.current=b,e(f)})},c):a(c.currentTarget).hasClass("grid_head")&&"undefined"==typeof f||d(!1,g.view.current==b,function(){g.view.current=b,e(f)}))):e(0)},searchPanel:function(b,c,d){var e=this,f=e.view.search.find(".search_main"),g=d?"main_search"==a(d.target).prop("id")||a(d.currentTarget).hasClass("res_item"):!1;null!==b?b?(e.view.search.data("par",e.view.current),e.view.current="search",e.view.search.css({visibility:"visible"}),f.animate({right:"0px"},e.options.animation)):g&&(e.view.current=e.view.search.data("par"),f.animate({right:"-500px"},e.options.animation,function(){e.view.search.css({visibility:"hidden"}),"function"==typeof c&&c()})):a.isEmptyObject(e.options.searchData)?a.ajax({type:"get",url:"assets/response/search.php",processData:!1,contentType:!1,dataType:"json",success:function(a){e.options.searchData=a,e.fill(null)},error:function(a){var b=e.view.search.find(".search_results");b.find(".ctrl_scroll_cont").html("Error: Unable to retrieve search results.<br/><br/>Please try again."),b.jScroll("update")}}):e.fill(null)},switchImage:function(b){var c=this,d=a(b.currentTarget);c.view.item.find(".item_imgs_main").html('<img src="'+d.prop("src")+'" />'),c.view.item.find(".item_imgs_thmb").find("img").removeClass("selected"),d.addClass("selected")},fill:function(b){function c(b,c){e.ctrl.html("");for(var d in e.options.map[e.view.current].other){var f=a('<div class="button_base button_'+d+'"><div></div>'+e.options.map[e.view.current].other[d]+"</div>");if("undefined"!=typeof b)for(var g in b)"prev"!=d&&"next"!=d||"undefined"==typeof c||f.toggleClass("disabled",c[d]),g==d&&f.data("id",b[d]);f.appendTo(e.ctrl)}}var d,e=this;switch(e.view.current){case"error":e.back.css({display:"none"}),e.mttl.html("Shop that video");break;case"start":d=e.options.adData,e.back.css({display:null==e.options.map[e.view.current].back?"none":"block"}),e.mttl.html("Shop that video"),c();var f=e.view.start.find(".grid_body"),g=e.view.start.find(".grid_head"),h=a('<div class="grid_item">!img!<div class="grid_item_ovr"><div class="grid_item_ttl">!ttl!</div><div class="grid_item_dsc">!dsc!</div></div></div>');g.find(".head_ttl").html(d.Name),g.find(".head_img").html('<img src="'+d.Thumbnail+'" />'),g.find(".head_dsc").html(d.Description),g.data("id",0),f.html("");for(var i=1;i<d.ProductGroupTimeLine.length;i++){var j=h.clone();j.replaceText(/!img!/gi,'<img src="'+d.ProductGroupTimeLine[i].Thumbnail+'" />'),j.find(".grid_item_ttl").replaceText(/!ttl!/gi,d.ProductGroupTimeLine[i].Title),j.find(".grid_item_dsc").replaceText(/!dsc!/gi,d.ProductGroupTimeLine[i].Description),j.data("id",i),j.appendTo(f)}e.view.start.gridView("update",!0);break;case"play":d=e.options.adData,e.back.css({display:null==e.options.map[e.view.current].back?"none":"block"}),e.mttl.html(d.Name?d.Name:"Shop that video"),e.view.play.adPlayer("load",{video:d.Media,poster:d.Thumbnail,groups:d.ProductGroupTimeLine.map(function(a){return a.Time||null})});break;case"group":e.vals.group=b,d=e.options.adData[e.vals.video].ProductGroupTimeLine[e.vals.group],e.back.css({display:null==e.options.map[e.view.current].back?"none":"block"}),e.mttl.html(d.Title||"Untitled group"),c({prev:Math.max(0,e.vals.group-1),next:Math.min(e.options.adData[e.vals.video].ProductGroupTimeLine.length-1,e.vals.group+1)},{prev:e.vals.group-1<0,next:e.vals.group+1>e.options.adData[e.vals.video].ProductGroupTimeLine.length-1});var f=e.view.group.find(".grid_body"),g=e.view.group.find(".grid_head"),h=a('<div class="grid_item">!img!<div class="grid_item_ttl">!ttl!</div><div class="grid_item_dsc">!dsc!</div></div>');e.view.group.data("time",e.options.adData[e.vals.video].ProductGroupTimeLine[e.vals.group].Time),g.find(".head_ttl").html(d.Subtitle||"Untitled"),g.find(".head_img").html('<img src="'+(d.Thumbnail||"Assets/blank_rectangle.png")+'" />'),g.find(".head_lnk").html(d.MakeThisYourLookURL?'<a class="button_buy" href="'+d.MakeThisYourLookURL+'" target="_blank">Make this your look!</a>':""),g.find(".head_dsc").html(d.Description||"No description found"),f.html("");for(var i=0;i<d.Products.length;i++){var j=h.clone();j.replaceText(/!img!/gi,'<img src="'+(d.Products[i].ProductImages[0]||"Assets/blank_square.png")+'" />'),j.find(".grid_item_ttl").replaceText(/!ttl!/gi,d.Products[i].Name||"Untitled"),j.find(".grid_item_dsc").replaceText(/!dsc!/gi,d.Products[i].Description||"No description found"),j.data("id",i),j.appendTo(f)}e.view.group.gridView("update",!0);break;case"groups":d=e.options.adData[e.vals.video],e.back.css({display:null==e.options.map[e.view.current].back?"none":"block"}),e.mttl.html(d.Name||"Untitled ad"),c();var f=e.view.groups.find(".grid_body"),h=a('<div class="grid_item"><div class="grid_item_ttl">!ttl!</div>!img!<div class="grid_item_lnk">!lnk!</div><div class="grid_item_stl">!stl!</div><div class="grid_item_dsc">!dsc!</div></div>');f.html("");for(var i=0;i<d.ProductGroupTimeLine.length;i++){var j=h.clone();j.find(".grid_item_ttl").replaceText(/!ttl!/gi,d.ProductGroupTimeLine[i].Title||"Untitled group"),j.replaceText(/!img!/gi,'<img src="'+(d.ProductGroupTimeLine[i].Thumbnail||"Assets/blank_rectangle.png")+'" />'),j.find(".grid_item_lnk").replaceText(/!lnk!/gi,d.ProductGroupTimeLine[i].MakeThisYourLookURL?'<a class="button_buy" href="'+d.ProductGroupTimeLine[i].MakeThisYourLookURL+'" target="_blank">Make this your look!</a>':""),j.find(".grid_item_stl").replaceText(/!stl!/gi,d.ProductGroupTimeLine[i].Subtitle||"Untitled"),j.find(".grid_item_dsc").replaceText(/!dsc!/gi,d.ProductGroupTimeLine[i].Description||"No description found"),j.data("id",i),j.appendTo(f)}e.view.groups.gridView("update",!0);break;case"item":e.vals.item=b,d=e.options.adData[e.vals.video].ProductGroupTimeLine[e.vals.group].Products[e.vals.item],e.back.css({display:null==e.options.map[e.view.current].back?"none":"block"}),e.mttl.html(d.Name||"Untitled product"),c({up:e.vals.group});var k=e.view.item.find(".item_colr_cont").html(""),l=e.view.item.find(".item_size_cont").html(""),m=e.view.item.find(".item_revw_rgrp"),n=m.find(".ctrl_scroll_cont").html(""),o=e.view.item.find(".item_imgs_main").html(""),p=e.view.item.find(".item_imgs_thmb"),q=p.find(".ctrl_scroll_cont").html(""),r=e.view.item.find(".item_info").outerWidth(!0);e.view.item.find(".item_sttl").html(d.Subtitle||"Untitled"),e.view.item.find(".item_price").html(d.Price.PriceValue||"$0.00"),e.view.item.find(".item_desc").html(d.Description||"No description found"),e.view.item.find(".item_link").html(d.MakeThisYourLookURL?'<a class="button_buy" href="'+d.MakeThisYourLookURL+'" target="_blank">Make this your look!</a>':""),d.ProductColors.length?a.each(d.ProductColors,function(){a('<div class="item_colr_item" style="background: '+this.ColorValue+';"></div>').appendTo(k)}):e.view.item.find(".item_colr").hide(),d.Sizes.length?a.each(d.Sizes,function(){a('<div class="item_size_item">'+this+"</div>").appendTo(l)}):e.view.item.find(".item_size").hide(),e.options.showReviews&&Object.keys(d.Reviews).length?(a.each(d.Reviews,function(){var b=a('<div class="item_revw_item"><div class="item_revw_item_name">'+this.ReviewName+'</div><div class="item_revw_item_rtng"></div><div class="item_revw_item_desc">'+this.ReviewText+"</div></div>"),c=b.find(".item_revw_item_rtng");for(i=0;i<this.ReviewRating;i++)a('<div class="item_revw_item_rtng_pos"></div>').appendTo(c);for(i=0;i<5-this.ReviewRating;i++)a('<div class="item_revw_item_rtng_neg"></div>').appendTo(c);b.appendTo(n)}),r+=e.view.item.find(".item_revw").outerWidth(!0),m.jScroll("update")):e.view.item.find(".item_revw").hide(),d.ProductImages.length?(a('<img src="'+d.ProductImages[0]+'" />').appendTo(o),a.each(d.ProductImages,function(b){a('<img src="'+this+'" class="item_thmb'+(0==b?" selected":"")+'" />').appendTo(q)}),r+=e.view.item.find(".item_imgs").outerWidth(!0),p.jScroll("update")):e.view.item.find(".item_imgs").hide(),e.view.item.find(".item_body").css({width:r+"px"}),e.view.item.find(".item_main").jScroll("update");break;case"search":d=e.options.searchData;var f=e.view.search.find(".search_results"),s=f.find(".ctrl_scroll_cont").html(""),h=a('<div class="res_item">!img!<div class="res_item_ttl">!ttl!</div><div class="res_item_dsc">!dsc!</div></div>');if(d.length){for(var i=0;i<d.length;i++){var j=h.clone();j.replaceText(/!img!/gi,'<img src="'+d[i].Thumbnail+'" />'),j.find(".res_item_ttl").replaceText(/!ttl!/gi,d[i].Name),j.find(".res_item_dsc").replaceText(/!dsc!/gi,d[i].Description),j.data("id",i),j.appendTo(s)}f.jScroll("update")}else s.html("<span>No results found.<span>")}},attachEvents:function(){var b=this;b.orig.on("click.videoAd touch.videoAd",".button_search",a.proxy(b.searchPanel,b,!0,null)),b.orig.on("click.videoAd touch.videoAd","#main_search",a.proxy(b.searchPanel,b,!1,null)),b.orig.on("click.videoAd touch.videoAd",".button_go",a.proxy(b.searchPanel,b,null,null)),b.orig.on("click.videoAd touch.videoAd",".res_item",a.proxy(b.switchView,b,"play")),b.orig.on("click.videoAd touch.videoAd",'.button_up, .button_prev:not(".disabled"), .button_next:not(".disabled")',a.proxy(b.switchView,b,"group")),b.orig.on("click.videoAd touch.videoAd",".grid_item, .grid_head",a.proxy(b.switchView,b,null)),b.orig.on("click.videoAd touch.videoAd",".button_all",a.proxy(b.switchView,b,"groups")),b.orig.on("click.videoAd touch.videoAd",".button_start",a.proxy(b.switchView,b,"start")),b.view.play.on("adPlayerPause",a.proxy(b.switchView,b,null)),b.view.play.on("adPlayerEnd",a.proxy(b.switchView,b,"groups")),b.orig.on("click.videoAd touch.videoAd",".button_resume",a.proxy(b.switchView,b,null)),b.orig.on("click.videoAd touch.videoAd",".button_locate",a.proxy(b.switchView,b,null)),b.orig.on("click.videoAd touch.videoAd",".item_thmb",a.proxy(b.switchImage,b))},canPlay:function(){var a=this,b=a.vals,c=document.createElement("video");b.canpl=!1,c.canPlayType&&(b.canpl="probably"==c.canPlayType('video/mp4; codecs="avc1.42E01E, mp4a.40.2"'))}};a.fn.videoAd=function(c,d){return this.each(function(){var e=a.data(this,"vAd");if(e){if(e[c])return e[c](d)}else e=Object.create(b),e.init(this,c),a.data(this,"vAd",e)})},a.fn.videoAd.defaults={adData:[],searchData:[],showReviews:!0,start:"start",animation:200,map:{start:{back:null,item:"play",other:{search:"Search"}},play:{back:"start",item:"group"},group:{back:"play",item:"item",other:{locate:"Seek and play",prev:"Previous",all:"All groups",next:"Next",start:"Home",search:"Search"}},groups:{back:"play",item:"group",other:{start:"Home",search:"Search"}},item:{back:"play",item:null,other:{up:"Back to group",start:"Home",search:"Search"}}}}}(jQuery);var mul_table=[1,171,205,293,57,373,79,137,241,27,391,357,41,19,283,265,497,469,443,421,25,191,365,349,335,161,155,149,9,278,269,261,505,245,475,231,449,437,213,415,405,395,193,377,369,361,353,345,169,331,325,319,313,307,301,37,145,285,281,69,271,267,263,259,509,501,493,243,479,118,465,459,113,446,55,435,429,423,209,413,51,403,199,393,97,3,379,375,371,367,363,359,355,351,347,43,85,337,333,165,327,323,5,317,157,311,77,305,303,75,297,294,73,289,287,71,141,279,277,275,68,135,67,133,33,262,260,129,511,507,503,499,495,491,61,121,481,477,237,235,467,232,115,457,227,451,7,445,221,439,218,433,215,427,425,211,419,417,207,411,409,203,202,401,399,396,197,49,389,387,385,383,95,189,47,187,93,185,23,183,91,181,45,179,89,177,11,175,87,173,345,343,341,339,337,21,167,83,331,329,327,163,81,323,321,319,159,79,315,313,39,155,309,307,153,305,303,151,75,299,149,37,295,147,73,291,145,289,287,143,285,71,141,281,35,279,139,69,275,137,273,17,271,135,269,267,133,265,33,263,131,261,130,259,129,257,1],shg_table=[0,9,10,11,9,12,10,11,12,9,13,13,10,9,13,13,14,14,14,14,10,13,14,14,14,13,13,13,9,14,14,14,15,14,15,14,15,15,14,15,15,15,14,15,15,15,15,15,14,15,15,15,15,15,15,12,14,15,15,13,15,15,15,15,16,16,16,15,16,14,16,16,14,16,13,16,16,16,15,16,13,16,15,16,14,9,16,16,16,16,16,16,16,16,16,13,14,16,16,15,16,16,10,16,15,16,14,16,16,14,16,16,14,16,16,14,15,16,16,16,14,15,14,15,13,16,16,15,17,17,17,17,17,17,14,15,17,17,16,16,17,16,15,17,16,17,11,17,16,17,16,17,16,17,17,16,17,17,16,17,17,16,16,17,17,17,16,14,17,17,17,17,15,16,14,16,15,16,13,16,15,16,14,16,15,16,12,16,15,16,17,17,17,17,17,13,16,15,17,17,17,16,15,17,17,17,16,15,17,17,14,16,17,17,16,17,17,16,15,17,16,14,17,16,15,17,16,17,17,16,17,15,16,17,14,17,16,15,17,16,17,13,17,16,17,17,16,17,14,17,16,17,16,17,16,17,9];!function(a){var b={init:function(b,c){var d=this;d.elem=a(b),d.vals={contO:0,thmbO:0,mouse:0},d.options=a.extend({},a.fn.jScroll.defaults,c),d.build()},build:function(){var a=this,b=a.vals;b.isV="v"==a.options.mode,b.outerSize=b.isV?"outerHeight":"outerWidth",b.marginPos=b.isV?"right":"bottom",b.elemSize=b.isV?"height":"width",b.elemOfst=b.isV?"top":"left",b.mouseDir=b.isV?"Y":"X",b.hasScroll=!1,b.hasMouse=!1,b.scrolling=null,a.elem.wrapInner('<div class="ctrl_scroll_view ctrl_scroll_'+a.options.mode+'"><div class="ctrl_scroll_cont"></div></div>').append('<div class="ctrl_scroll_trck ctrl_scroll_trck_'+a.options.mode+'"><div class="ctrl_scroll_thmb ctrl_scroll_thmb_'+a.options.mode+' ctrl_trans"></div></div>'),a.view=a.elem.children(".ctrl_scroll_view"),a.cont=a.view.children(".ctrl_scroll_cont"),a.trck=a.elem.children(".ctrl_scroll_trck"),b.isV&&a.trck.css({top:parseInt(a.elem.css("paddingTop"),10)+"px"}),a.thmb=a.trck.children(".ctrl_scroll_thmb"),a.trck.css(b.marginPos,-1*(a.options.pad+a.trck[b.isV?"outerWidth":"outerHeight"]())+"px"),b.thmbP=a.thmb[b.outerSize](!0),a.attachEvents()},update:function(){var a=this,b=a.vals;b.viewS=a.view[b.outerSize](!0),b.contS=a.cont[b.outerSize](!0),b.contS>b.viewS?(b.contO=Math.min(b.contS-b.viewS,Math.max(0,b.contO)),b.thmbS=Math.min(b.viewS-b.thmbP,Math.max(a.options.min,b.viewS/b.contS*b.viewS)),a.trck.css({display:b.hasMouse?"block":"none"}).css(b.elemSize,b.viewS+"px"),a.thmb.css(b.elemSize,b.thmbS+"px"),a.cont.css(b.elemOfst,-b.contO+"px"),b.ratio=(b.contS-b.viewS)/(b.viewS-a.thmb[b.outerSize](!0)),b.thmbO=b.contO/b.ratio,a.thmb.css(b.elemOfst,b.thmbO+"px"),b.hasScroll=!0):(b.thmbO=b.contO=0,a.trck.css({display:"none"}),a.thmb.css(b.elemOfst,b.thmbO+"px"),a.cont.css(b.elemOfst,b.contO+"px").css({padding:"0px"}),b.hasScroll=!1)},attachEvents:function(b,c){var d=this,e=d.vals;"undefined"==typeof c?(a(document).on("mouseover.jScroll","body",a.proxy(d.attachEvents,d,!0)),d.elem.on("DOMMouseScroll.jScroll mousewheel.jScroll",a.proxy(d.events.wheel,d)),d.view.on("touchstart.jScroll",a.proxy(d.events.start,d)),d.options.autoresize&&a(window).on("resize.jScroll",a.proxy(d.update,d))):(a(document).off("mouseover.jScroll"),b&&(e.hasMouse=!0,d.thmb.on("mousedown.jScroll",a.proxy(d.events.start,d)),d.trck.on("click.jScroll",a.proxy(d.events.jump,d)))),d.update()},scrollTo:function(a){var b=this,c=b.vals,d=Math.min(c.contS-c.viewS,Math.max(0,a));c.hasMouse||b.scrollToggle(!0),d!=c.contO&&(c.contO=d,c.thmbO=Math.min(c.viewS-c.thmbP-c.thmbS,Math.max(0,c.contO/c.ratio)),b.cont.css(c.elemOfst,-1*c.contO+"px"),b.thmb.css(c.elemOfst,c.thmbO+"px"))},scrollToggle:function(a){var b=this,c=b.vals;c.hasScroll&&(a?(null!==c.scrolling?clearTimeout(c.scrolling):b.trck.fadeIn(200),c.scrolling=setTimeout(function(){b.scrollToggle(!1)},2e3)):(c.scrolling=null,b.trck.fadeOut(200)))},events:{start:function(b){var c=this,d=c.vals,e="mousedown"==b.type;d.start=e?b["page"+d.mouseDir]:b.originalEvent.touches[0]["screen"+d.mouseDir],c.thmb.toggleClass("ctrl_scroll_thmb_d"),a(document).on((e?"mousemove":"touchmove")+".jScroll",a.proxy(c.events.move,c)),a(document).on("mouseup.jScroll touchend.jScroll",a.proxy(c.events.end,c)),d.hasMouse&&b.preventDefault()},move:function(a){var b,c=this,d=c.vals,e="mousemove"==a.type,f=e?a["page"+d.mouseDir]:a.originalEvent.touches[0]["screen"+d.mouseDir],g=f-d.start;d.contS>d.viewS&&(d.start=f,b=e?(d.thmbO+g)*d.ratio:(d.thmbO-g)*d.ratio,c.scrollTo(b)),a.preventDefault()},wheel:function(a){var b=this,c=b.vals,d=40*(a.originalEvent.wheelDelta?a.originalEvent.wheelDelta/120:-a.originalEvent.detail/3);a.preventDefault(),a.stopPropagation(),c.contS>c.viewS&&b.scrollTo(c.contO-d)},jump:function(b){var c=this,d=c.vals;if(b.target==b.delegateTarget){var e,f=a(b.target).offset()[d.elemOfst],g=f+d.thmbO,h=g+d.thmbS;e=b["page"+d.mouseDir]>h?(d.thmbO+d.thmbS)*d.ratio:(d.thmbO-d.thmbS)*d.ratio,c.scrollTo(e)}},end:function(b){var c=this;c.thmb.toggleClass("ctrl_scroll_thmb_d"),a(document).off(".jScroll")}}};a.fn.jScroll=function(c,d){return this.each(function(){var e=a.data(this,"jScroll");e?e[c]&&e[c](d):(e=Object.create(b),e.init(this,c),a.data(this,"jScroll",e))})},a.fn.jScroll.defaults={pad:10,min:20,mode:"v",autoresize:!0}}(jQuery),angular.module("shopthatvid",["ui.bootstrap","ui.utils","ui.router","ngAnimate"]),angular.module("shopthatvid").constant("GLOBALS",{adUrl:"http://shoppable-cms.herokuapp.com/api",searchUrl:"data/search.json",projectGroupUrl:"data/product_group.json",showProductReviews:!1,showProductColors:!0,showProductSizes:!0,apiUrl:"http://shoppable-cms.herokuapp.com/api/"}).value("NavbarConfig",{showProjectGroup:!1,showItem:!1,showVideoResumeButton:!1,disableNext:!1,disablePrev:!1}).value("ViewTypes",{HOME:"HOME",PRODUCT_GROUP:"PRODUCT_GROUP",PRODUCT_GROUPS:"PRODUCT_GROUPS",PRODUCT_ITEM:"PRODUCT_ITEM"}).config(["$stateProvider","$urlRouterProvider","$locationProvider",function(a,b,c){a.state("home",{url:"/",templateUrl:"../views/home.html",controller:"HomeCtrl",resolve:{projects:["$rootScope","adService",function(a,b){return b.getAds().success(function(b,c){return b||a.displayError("Error Occurred while fetchig the video ad content."),b}).error(function(b,c){a.displayError()})}]}}).state("productGroup",{url:"/ad/:videoId/productGroup/:productGroupId",templateUrl:"../views/product-group.html",controller:"ProductGroupCtrl",resolve:{productGroup:["$rootScope","$stateParams","adService","$state",function(a,b,c,d){return c.getProductGroup(b.videoId,b.productGroupId)}]}}).state("product",{url:"/ad/:videoId/productGroup/:productGroupId/product/:productId",templateUrl:"../views/product.html",controller:"ProductCtrl",resolve:{product:["$rootScope","$stateParams","adService","$state",function(a,b,c,d){return c.getProduct(b.videoId,b.productGroupId,b.productId)}]}}).state("productGroups",{url:"/ad/:videoId/productGroups",templateUrl:"../views/product-groups.html",controller:"ProductGroupsCtrl",resolve:{productGroups:["$rootScope","$stateParams","adService","$state",function(a,b,c,d){return c.getProductGroups(b.videoId)}]}}),b.otherwise("/")}]),angular.module("shopthatvid").run(["$rootScope","$http","NavbarConfig","ViewTypes","adService",function(a,b,c,d,e){var f=function(a){a&&void 0===a.length?_.each(a,function(b,c){var d=c;c="ID"===c?"id":c.charAt(0).toLowerCase()+c.slice(1),a[c]=b,delete a[d],a[c]&&"object"==typeof a[c]&&f(a[c])}):a&&a.length>0&&_.each(a,function(a){"object"==typeof a&&f(a)})},g={};e.getAds().success(function(b,c,d){console.log(b),f(b);var h=b[g.videoId]||b[0];if(a.paramVideoId=g.videoId||0,h){a.shoppableVideoSAS=h.shoppableVideoSAS;h.shoppableVideoBlobURL+h.shoppableVideoSAS;e.getAd({ShoppableVideoUrl:h.shoppableVideoBlobURL,ShoppableVideoSAS:h.shoppableVideoSAS}).success(function(b,c,d){f(b),b=b.shoppableVideo;for(var g=b.productGroups.length-1;g>=0;g--){var i=b.productGroups[g];(null===i.productGroupImageUrl||null===i.productGroupImageSAS)&&b.productGroups.splice(g,1)}b?e.getVideoUrl(b.videoId).success(function(c,d){f(c),b.videoDetail=c.videoDetail,b.videoThumbnail=h.imageBlobURL+h.imageSAS,a.currentAd=b,a.$broadcast("adDataLoaded",b),console.log("currentAd: ",b)}).error(function(b){console.log("error in getting VideoUrl: ",b),a.displayError("Error Occurred while fetchig the video ad content.")}):a.displayError("Error Occurred while fetchig the video ad content.")}).error(function(a,b,c){console.log("Error fetching Ad details: ",a,b,c)})}else console.log("Ads not found...")}).error(function(a,b,c){console.log("Error fetching Ad list: ",a,b,c)}),a.navbar=c,a.uiConfig={showMainContent:!0,showVideo:!1,currentPage:d.HOME},a.changeNavbar=function(b){a.uiConfig.currentPage=b,b===d.PRODUCT_GROUP?(a.navbar.showProjectGroup=!0,a.navbar.showProjectGroups=!1,a.navbar.showItem=!1,a.navbar.showVideoResumeButton=!0):b===d.PRODUCT_GROUPS?(a.navbar.showProjectGroup=!1,a.navbar.showProjectGroups=!0,a.navbar.showItem=!1,a.navbar.showVideoResumeButton=!0):b===d.PRODUCT_ITEM?(a.navbar.showProjectGroup=!1,a.navbar.showProjectGroups=!1,a.navbar.showItem=!0,a.navbar.showVideoResumeButton=!0):(a.navbar.showProjectGroup=!1,a.navbar.showProjectGroups=!1,a.navbar.showItem=!1,a.navbar.showVideoResumeButton=!1)},a.displayError=function(b){a.uiConfig.showVideo=!1,a.uiConfig.showMainContent=!1,b?a.error=b:a.error="Something went wrong, Please try again later OR contact Administrator."}}]),angular.module("shopthatvid").directive("includeReplace",function(){return{
require:"ngInclude",restrict:"A",link:function(a,b){b.replaceWith(b.children())}}}),angular.module("shopthatvid").directive("bVideoAd",["$rootScope","$timeout","$state","adService",function(a,b,c,d){return{restrict:"A",scope:{player:"="},link:function(b,e){b.player=$("#main_play").adPlayer(),b.player.on("adPlayerPause",function(b){console.log("Ad player paused...",b);var e=$(b.currentTarget).data("id"),f=d.getCurrentAd();c.go("productGroup",{videoId:f._id,productGroupId:e}).then(function(){a.uiConfig.showMainContent=!0})}),b.player.on("adPlayerEnd",function(b,d){console.log("Ad player ended...",b,d),c.go("productGroups",{videoId:a.currentVideoId}).then(function(){a.uiConfig.showMainContent=!0,a.uiConfig.showVideo=!0})}),a.$on("adDataLoaded",function(a,c){var e=d.getCurrentAd();b.player.adPlayer("load",{video:e.videoDetail.videos[0].url,poster:e.videoThumbnail,groups:e.timeline.timelineItems.map(function(a){return angular.isNumber(a.start)?a.start:null})})}),a.$on("play",function(c,e){var f=e&&e.item,g=e&&e.index;if(f){var h=d.getCurrentAd(),i=h.timeline.timelineItems[g].start;b.player.adPlayer("load",{video:h.videoDetail.videos[0].url,poster:f.productGroupImageUrl+f.productGroupImageSAS,seekTime:i,groups:h.timeline.timelineItems.map(function(a){return angular.isNumber(a.start)?a.start:null})})}a.uiConfig.showMainContent=!1,a.uiConfig.showVideo=!0}),a.$on("resume",function(){a.uiConfig.showMainContent=!1,a.uiConfig.showVideo=!0,b.player.adPlayer("play",!1,function(c){if(!c){var e=d.getCurrentAd();e?(b.player.adPlayer("load",{video:e.videoDetail.videos[0].url,poster:e.videoThumbnail,groups:e.timeline.timelineItems.map(function(a){return angular.isNumber(a.start)?a.start:null})}),b.player.adPlayer("play")):d.getAd(a.currentVideoId).success(function(a,c){e=a,b.player.adPlayer("load",{video:e.videoDetail.videos[0].url,poster:e.videoThumbnail,groups:e.timeline.timelineItems.map(function(a){return angular.isNumber(a.start)?a.start:null})}),b.player.adPlayer("play")}).error(function(b,c){a.displayError(b.message)})}})}),a.$on("seekAndPlay",function(c,d){a.uiConfig.showMainContent=!1;var e=a.currentAd.timeline.timelineItems[a.currentProductGroupId]&&a.currentAd.timeline.timelineItems[a.currentProductGroupId].start;void 0===e||null===e?a.displayError("Error while seeking to the selected ProductGroup."):b.player.adPlayer("seek",e,function(){console.log("seek done..."),b.showVideo=!0,a.uiConfig.showVideo=!0,a.$apply(),b.player.adPlayer("play")})})}}}]),angular.module("shopthatvid").directive("svGridView",["$rootScope","$interval",function(a,b){return{restrict:"A",scope:{bodyItems:"=",headItem:"="},link:function(a,b,c){var d;console.log("scope.headItem",a.headItem),console.log("scope.bodyItems",a.bodyItems),d=angular.element(b).gridView({template:c.templateType,itemWidth:60,itemHeight:110}),a.$watch("itemLength",function(){d.gridView("update",!0)},!0)}}}]).directive("svScroll",["$rootScope","$interval",function(a,b){return{restrict:"A",scope:{itemLength:"=",item:"@",searchScroll:"="},link:function(a,c){a.$watch("itemLength",function(){var d=b(function(){var e=angular.element(c).find("["+a.item+"]");e.length===a.itemLength&&(b.cancel(d),a.searchScroll=angular.element(c).jScroll({pad:23}))},200)},!0)}}}]),angular.module("shopthatvid").filter("removeSpaces",function(){return function(a){return angular.isDefined(a)?a.replace(/\s/g,""):""}}).filter("fromNow",function(){return function(a){return angular.isDefined(a)?moment(a).fromNow():""}}).filter("elipsis",function(){return function(a,b){return angular.isDefined(a)?a.length>b?a.substring(0,b)+"...":a:""}}).filter("ucFirst",function(){return function(a){return angular.isDefined(a)?a.charAt(0).toUpperCase()+a.slice(1):""}}).filter("linkify",function(){return function(a){var b=/(\b(https?|ftp|file):\/\/[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|])/gi;return a.replace(b,'<a href="$1" target="_blank">$1</a>')}}).filter("prependProtocol",function(){return function(a){return a?a.indexOf("http")<0?"http://"+a:a:"#"}}).filter("htmlToPlaintext",function(){return function(a){return String(a).replace(/<[^>]+>/gm,"")}}).filter("phoneNumber",function(){return function(a){if("string"!=typeof a)return"";var b=a.replace(/[^0-9]/g,""),c=/^1?([2-9]..)([2-9]..)(....)$/;return b.replace(c,"($1) $2 $3")}}).filter("decimal",function(){return function(a,b){return isNaN(a)?a:parseFloat(a).toFixed(b)}}).filter("age",function(){return function(a,b){if(b=b||"Unknown",a){var c=new Date(a),d=new Date,e=d-c;return Math.floor(e/31536e6)}return"Unknown"}}).filter("checkNull",function(){return function(a,b){return a||b}}).filter("rectangleThumb",function(){return function(a){return a||"assets/images/blank_rectangle.png"}}).filter("squareThumb",function(){return function(a){return a||"assets/images/blank_square.png"}}).filter("zeroleading",function(){return function(a){var b=a.toString();return 1===b.length?"0"+b:b}}).filter("productGroupImage",["$rootScope",function(a){return function(a){return a?a.productGroupImageUrl+a.productGroupImageSAS:"assets/content/products/group_01.png"}}]).filter("productImage",["$rootScope",function(a){return function(a){return a?a.productImageUrl+a.productImageSAS:"assets/content/products/group_02_shoes.png"}}]).filter("toMinute",function(){return function(a){var b=parseInt(a),c=parseInt(b/60),d=parseInt(b%60),e="";return e+=1===c.toString().length?"0"+c+" : ":c+" : ",e+=1===d.toString().length?"0"+d:d}}),angular.module("shopthatvid").service("adService",["$http","$rootScope","GLOBALS",function(a,b,c){this.currentAd=void 0,this.currentProductGroup=void 0,this.currentProduct=void 0;var d=function(a){a&&void 0===a.length?_.each(a,function(b,c){var e=c;c="ID"===c?"id":c.charAt(0).toLowerCase()+c.slice(1),a[c]=b,delete a[e],a[c]&&"object"==typeof a[c]&&d(a[c])}):a&&a.length>0&&_.each(a,function(a){"object"==typeof a&&d(a)})};return{convertPropertyName:d,getAds:function(){return a.get(c.adUrl+"/projects")},getAd:function(d){return b.currentVideoPostData=d,a({method:"POST",cache:!0,url:c.adUrl+"/projects/"+videoId+"/true"})},getCurrentAd:function(){return b.currentAd?b.currentAd:null},getVideoUrl:function(b){return a.post(c.apiUrl+"getvideoinfo",{VideoId:b})},getProductGroup:function(a,c){return b.currentVideoId=a,b.currentProductGroupId=c,b.currentAd?(b.currentProductGroup=b.currentAd.productGroupTimeLine[c],b.currentProductGroup):null},getCurrentProductGroup:function(){return b.currentProductGroup?b.currentProductGroup:null},getProductGroups:function(a){return b.currentVideoId=a,b.currentAd?b.currentAd.productGroupTimeLine:null},getCurrentProductGroups:function(){return this.currentProductGroups?this.currentProductGroups:null},getProduct:function(a,c,d){return b.currentVideoId=a,b.currentProductGroupId=c,b.currentProductId=d,b.currentAd?(b.currentProduct=b.currentAd.productGroupTimeLine[c]?b.currentAd.productGroupTimeLine[c].products[d]:null,b.currentProduct):null},getCurrentProduct:function(){return this.currentProduct?this.currentProduct:null},getSearchData:function(b){var d=this;return a({method:"GET",url:c.searchUrl,transformResponse:function(a,c){var e=d.getCurrentAd();if(e&&b.length>0){var f=_.filter(e.productGroupTimeLine,function(a,c){return a.index=c,0===a.title.search(new RegExp(b,"i"))||0===a.subtitle.search(new RegExp(b,"i"))});return f}return[]}})}}}]),angular.module("shopthatvid").factory("safeApply",["$rootScope",function(a){return function(b){var c=a.$$phase;"$apply"===c||"$digest"===c?b&&"function"==typeof b&&b():this.$apply(b)}}]),angular.module("shopthatvid").controller("MainCtrl",["$scope","$state","$timeout","$rootScope","adService","ViewTypes",function(a,b,c,d,e,f){a.gotoHome=function(){var a=e.getCurrentAd();a?(console.log("currentAd",a),b.go("home",{videoId:a._id})):d.currentVideoId&&b.go("home",{videoId:d.currentVideoId})},a.resumePlayer=function(){d.$broadcast("resume")},a.showPrevious=function(){e.getCurrentAd();parseInt(d.currentProductGroupId)-1>=0&&(d.currentProductGroupId=parseInt(d.currentProductGroupId)-1,d.navbar.disableNext&&(d.navbar.disableNext=!1)),0===parseInt(d.currentProductGroupId)&&(d.navbar.disablePrev=!0),parseInt(d.currentProductGroupId)>=0&&b.go("productGroup",{videoId:d.currentVideoId,productGroupId:d.currentProductGroupId})},a.showNext=function(){var a=e.getCurrentAd();a&&a.productGroups.length>parseInt(d.currentProductGroupId)+1&&(d.currentProductGroupId=parseInt(d.currentProductGroupId)+1,d.navbar.disablePrev&&(d.navbar.disablePrev=!1)),a&&a.productGroups.length-1===parseInt(d.currentProductGroupId)&&(d.navbar.disableNext=!0),a&&a.productGroups.length>d.currentProductGroupId&&b.go("productGroup",{videoId:d.currentVideoId,productGroupId:d.currentProductGroupId})},a.seekAndPlay=function(){var a=e.getCurrentProductGroup();d.$broadcast("seekAndPlay",a)},a.showAllProductGroup=function(){b.go("productGroups",{videoId:d.currentVideoId})},a.toggleSearchPanel=function(){d.showSearchPanel?(d.openSearchPanel=!1,c(function(){d.showSearchPanel=!1},500,!0)):(d.showSearchPanel=!0,d.openSearchPanel=!0)},a.search=function(){var b=$("#search_text").val();e.getSearchData(b).success(function(b,d){console.log(b),a.searchData=b,a.showSearchResults=!0,a.searchScroll||(a.searchScroll=$("#main_search .search_results").jScroll({pad:23})),c(function(){a.searchScroll.jScroll("update")},1,!0)}).error(function(b,c){a.searchError="Error Occured."})},a.gobackToProductGroup=function(){b.go("productGroup",{videoId:d.currentVideoId,productGroupId:d.currentProductGroupId})}}]),angular.module("shopthatvid").controller("HomeCtrl",["$scope","$rootScope","$timeout","$stateParams","adService","projects","ViewTypes",function(a,b,c,d,e,f,g){b.uiConfig.showVideo=!1,b.navbar.headerTitle="Shop that video",b.changeNavbar(g.HOME),console.log("projects",f.data),a.projects=f.data,a.mainProject=a.projects[0],a.initStartView=function(){c(function(){var a=$("#main_start").gridView({template:"grid_start",itemWidth:60});a.gridView("update",!0),$("#main_start").find(".head_dsc").jScroll({autoresize:!0})},10)},a.startVideo=function(c){c?e.getAd(c._id).success(function(c,d){console.log("currentAd",c),b.currentAd=c,a.currentAd=c,b.$broadcast("adDataLoaded"),b.$broadcast("play")}).error(function(a){b.displayError()}):b.$broadcast("play")},b.$on("adDataLoaded",function(b){a.initStartView()});var h=e.getCurrentAd();h&&a.initStartView()}]),angular.module("shopthatvid").controller("ProductGroupCtrl",["$scope","$rootScope","$timeout","$state","$stateParams","productGroup","ViewTypes","adService",function(a,b,c,d,e,f,g,h){$("#main_group").css("opacity",0),b.$broadcast("videIdLoaded",e),0===parseInt(b.currentProductGroupId)&&(b.navbar.disablePrev=!0),a.initGroupView=function(){a.currentProductGroup&&c(function(){var a=$("#main_group").gridView({template:"grid_group",itemWidth:60,itemHeight:110});a.gridView("update",!0),$("#main_group").css("opacity",1);$("#main_group .grid_head .head_dsc").jScroll({autoresize:!0})},10,!0)};var i=h.getCurrentAd();i?(b.changeNavbar(g.PRODUCT_GROUP),a.currentProductGroup=f,b.navbar.headerTitle=a.currentProductGroup.title,i&&i.productGroupTimeLine.length-1===parseInt(b.currentProductGroupId)?b.navbar.disableNext=!0:b.navbar.disableNext=!1,a.initGroupView()):h.getAd(e.videoId).success(function(c,d){b.currentAd=c,f=h.getProductGroup(e.videoId,e.productGroupId),a.currentProductGroup=f,b.changeNavbar(g.PRODUCT_GROUP),b.$broadcast("adDataLoaded",f),b.navbar.headerTitle=a.currentProductGroup.title,c&&c.productGroupTimeLine.length-1===parseInt(b.currentProductGroupId)?b.navbar.disableNext=!0:b.navbar.disableNext=!1,a.initGroupView()}).error(function(a,b){console.log("error while fetching ad data.")}),a.openProduct=function(a,c){d.go("product",{videoId:b.currentVideoId,productGroupId:b.currentProductGroupId,productId:c})};var j=function(c){b.currentProductGroupId=e.productGroupId,a.initGroupView(),c&&c.productGroups.length-1===parseInt(b.currentProductGroupId)?b.navbar.disableNext=!0:b.navbar.disableNext=!1,b.changeNavbar(g.PRODUCT_GROUP),a.currentProductGroup=c.productGroups[b.currentProductGroupId],b.navbar.headerTitle=a.currentProductGroup.name};b.$on("adDataLoaded",function(a){var b=h.getCurrentAd();j(b)});var i=h.getCurrentAd();i&&j(i)}]),angular.module("shopthatvid").controller("ProductCtrl",["$scope","$rootScope","$timeout","$stateParams","product","ViewTypes","adService","GLOBALS",function(a,b,c,d,e,f,g,h){var i,j,k;a.initProductItemView=function(){a.currentProduct&&c(function(){i=$("#main_item").find(".item_main").jScroll({mode:"h",pad:23,autoresize:!0}),$("#main_item").find(".item_imgs_thmb").jScroll(),$("#main_item").find(".item_revw_rgrp").jScroll(),i.jScroll("update")},100,!0)};var l=g.getCurrentAd();l?(b.changeNavbar(f.PRODUCT_ITEM),a.currentProduct=e,b.navbar.headerTitle=a.currentProduct.name,a.currentMainImage=a.currentProduct.images[0],a.initProductItemView()):g.getAd(d.videoId).success(function(c,e){b.currentAd=c;var h=g.getProductGroup(d.videoId,d.productGroupId);b.changeNavbar(f.PRODUCT_ITEM),b.$broadcast("adDataLoaded",h),a.currentProduct=g.getProduct(d.videoId,d.productGroupId,d.productId),b.navbar.headerTitle=a.currentProduct.name,a.currentMainImage=a.currentProduct.images[0],a.initProductItemView()}).error(function(a,b){console.log("error while fetching ad data.")}),a.getNumber=function(a){return new Array(a)},a.updateMainImage=function(b){a.currentMainImage=b},a.imagesLoaded=function(){if(k=!0,j){var a=$("#main_item").find(".item_info").outerWidth(!0);a+=$("#main_item").find(".item_revw").outerWidth(!0),a+=$("#main_item").find(".item_imgs").outerWidth(!0),$("#main_item").find(".item_body").css({width:a+"px"}),i?i.jScroll("update"):(i=$("#main_item").find(".item_main").jScroll({mode:"h",pad:23,autoresize:!0}),i.jScroll("update"))}},a.reviewsLoaded=function(){if(k){var a=$("#main_item").find(".item_info").outerWidth(!0);a+=$("#main_item").find(".item_revw").outerWidth(!0),a+=$("#main_item").find(".item_imgs").outerWidth(!0),$("#main_item").find(".item_body").css({width:a+"px"}),i?i.jScroll("update"):(i=$("#main_item").find(".item_main").jScroll({mode:"h",pad:23,autoresize:!1}),i.jScroll("update"))}};var m=function(c){a.currentProduct=c.productGroups[b.currentProductGroupId]&&c.productGroups[b.currentProductGroupId].products[b.currentProductId],a.currentProduct?(b.navbar.headerTitle=a.currentProduct.name,a.currentMainImage=a.currentProduct.productImages[0],a.initProductItemView()):b.displayError("Selected product detail not found.")};b.$on("adDataLoaded",function(){var a=g.getCurrentAd();m(a)});var l=g.getCurrentAd();l&&m(l)}]),angular.module("shopthatvid").controller("ProductGroupsCtrl",["$scope","$rootScope","$timeout","$state","$stateParams","productGroups","ViewTypes","adService",function(a,b,c,d,e,f,g,h){b.changeNavbar(g.PRODUCT_GROUPS),b.$broadcast("videIdLoaded",e),console.log("productGroups",f);var i=h.getCurrentAd();i?b.navbar.headerTitle=i.name:h.getAd(e.videoId).success(function(a,c){b.$broadcast("adDataLoaded"),b.navbar.headerTitle=a.name}).error(function(a,b){console.log("error while fetching ad data.")}),a.productGroups=f,a.initGroupsView=function(){c(function(){var b=$("#main_groups").gridView({template:"grid_groups",columns:!1});b.gridView("update"),a.displayImage=!0},1,!0)},a.gotoProductGroup=function(a,c){d.go("productGroup",{videoId:b.currentVideoId,productGroupId:c})},b.$on("adDataLoaded",function(){var c=h.getCurrentAd();b.navbar.headerTitle=c.name,a.productGroups=c.productGroups,a.initGroupsView()});var i=h.getCurrentAd();i&&(b.navbar.headerTitle=i.name,a.productGroups=i.productGroups,a.initGroupsView())}]);